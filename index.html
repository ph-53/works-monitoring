<!DOCTYPE html>
<html>
<head>
  <title>Station Works Lookup</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    table { border-collapse: collapse; width: 100%; margin-top: 15px; }
    th, td { border: 1px solid #999; padding: 8px; text-align: left; }
    th { background: #f0f0f0; }
  </style>
</head>
<body>

  <h2>Station-wise Works</h2>

  <input id="station" placeholder="Enter Station Name">
  <button onclick="loadData()">Go</button>

  <table id="table" style="display:none;">
    <thead>
      <tr id="headers"></tr>
    </thead>
    <tbody id="rows"></tbody>
  </table>

<script>
  function loadData() {
    const station = document.getElementById("station").value.trim();
    if (!station) {
      alert("Enter station name");
      return;
    }

    fetch("https://script.google.com/macros/s/AKfycbyp-iBTOaYR2G0VyGs9HxQRWNA2Mbvw-SaEOHwAlu0TbvKpSizyMJ3kSYYRXjL4lE1Fzw/exec?station=" + encodeURIComponent(station))
      .then(res => res.json())
      .then(data => {
        const table = document.getElementById("table");
        const headers = document.getElementById("headers");
        const rows = document.getElementById("rows");

        headers.innerHTML = "";
        rows.innerHTML = "";

        if (data.length === 0) {
          alert("No data found");
          table.style.display = "none";
          return;
        }

        Object.keys(data[0]).forEach(key => {
          const th = document.createElement("th");
          th.textContent = key;
          headers.appendChild(th);
        });

        data.forEach(row => {
          const tr = document.createElement("tr");
          Object.values(row).forEach(val => {
            const td = document.createElement("td");
            td.textContent = val;
            tr.appendChild(td);
          });
          rows.appendChild(tr);
        });

        table.style.display = "table";
      })
      .catch(() => alert("Error loading data"));
  }
</script>

</body>
</html>